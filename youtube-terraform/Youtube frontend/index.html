<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Youtube</title>
    <link rel="icon" type="image/png" sizes="32x32" href="https://static.vecteezy.com/system/resources/previews/018/930/572/non_2x/youtube-logo-youtube-icon-transparent-free-png.png">
    <link rel="icon" type="image/png" sizes="192x192" href="https://upload.wikimedia.org/wikipedia/commons/4/42/YouTube_icon_%282013-2017%29.png">
    <style>
      html, body {
        background: #111 !important;
        color: #fff !important;
      }
      body {
        background: #111 !important;
        color: #fff !important;
      }
      /* Responsive video grid */
      .video-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 24px;
        padding: 16px 0;
        background: #111;
      }
      .video-card {
        background: #181818;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.18);
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 12px;
        cursor: pointer;
        transition: box-shadow 0.2s, background 0.2s;
      }
      .video-card:hover {
        box-shadow: 0 4px 16px rgba(0,0,0,0.32);
        background: #232323;
      }
      .video-card video {
        width: 100%;
        max-width: 100%;
        border-radius: 6px;
        background: #000;
        aspect-ratio: 16/9;
        margin-bottom: 8px;
        pointer-events: none; /* Prevent direct play in grid */
      }
      .filename, .video-title {
        font-size: 1rem;
        color: #fff;
        margin-top: 4px;
        text-align: center;
        word-break: break-all;
      }
      .video-info {
        color: #fff;
      }
      /* Main video player styles */
      .main-video-section {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 32px;
        margin: 32px 0;
        background: #111;
      }
      .main-video-player {
        width: 100%;
        max-width: 900px;
        background: #181818;
        border-radius: 10px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.4);
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: stretch;
        min-width: 0;
      }
      .main-video-player #custom-video-container {
        position: relative;
        width: 100%;
        background: #000;
        border-radius: 10px 10px 0 0;
        overflow: hidden;
      }
      .main-video-player video {
        width: 100%;
        max-width: 100%;
        border-radius: 10px 10px 0 0;
        background: #000;
        aspect-ratio: 16/9;
        display: block;
      }
      .main-video-title {
        color: #fff;
        font-size: 1.2rem;
        padding: 16px 24px 12px 24px;
        width: 100%;
        text-align: left;
        background: #181818;
        border-radius: 0 0 10px 10px;
        box-sizing: border-box;
      }
      /* Custom video controls */
      .custom-controls {
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(24,24,24,0.95);
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 8px 16px;
        z-index: 2;
        transition: opacity 0.2s;
        opacity: 1;
      }
      .custom-controls.hide {
        opacity: 0;
        pointer-events: none;
      }
      .custom-btn {
        background: none;
        border: none;
        color: #fff;
        font-size: 1.4rem;
        cursor: pointer;
        padding: 4px 8px;
        border-radius: 4px;
        transition: background 0.15s;
      }
      .custom-btn:hover {
        background: rgba(255,255,255,0.08);
      }
      .custom-progress {
        flex: 1;
        height: 6px;
        background: #333;
        border-radius: 3px;
        cursor: pointer;
        margin: 0 8px;
        position: relative;
      }
      .custom-progress-bar {
        height: 100%;
        background: #f00;
        border-radius: 3px;
        width: 0%;
        position: absolute;
        left: 0;
        top: 0;
        pointer-events: none;
      }
      .custom-time {
        color: #fff;
        font-size: 0.95rem;
        min-width: 60px;
        text-align: right;
      }
      .custom-volume {
        width: 80px;
        margin-left: 8px;
        background: #222;
        accent-color: #ff0000;
      }
      /* Navbar and sidebar dark theme */
      nav.flex-div, .nav-left, .nav-middle, .nav-right {
        background: #181818 !important;
        color: #fff !important;
      }
      .search-box input[type="text"] {
        background: #232323;
        color: #fff;
        border: 1px solid #333;
      }
      .search-box input[type="text"]::placeholder {
        color: #bbb;
      }
      .search-box img, .mic-icon, .user-icon, .logo, .menu-icon {
        filter: brightness(0.9) invert(0);
      }
      .sidebar {
        background: #181818;
        color: #fff;
        border-right: 1px solid #222;
      }
      .sidebar .shortcut-links a,
      .sidebar .subscribed-list a {
        color: #fff;
        background: none;
      }
      .sidebar .shortcut-links a:hover,
      .sidebar .subscribed-list a:hover {
        background: #232323;
      }
      .sidebar hr {
        border-color: #222;
      }
      .sidebar .subscribed-list h3 {
        color: #fff;
      }
      .sidebar img {
        background: #232323;
        border-radius: 50%;
      }
      .container {
        background: #111;
      }
      .banner img {
        border-radius: 8px;
        width: 100%;
        background: #111;
      }
      #error-message {
        color: #ff6666;
        background: #222;
        padding: 8px 16px;
        border-radius: 6px;
        margin-top: 16px;
      }
      /* Upload modal dark theme */
      #upload-page {
        background: rgba(0,0,0,0.85) !important;
      }
      #upload-page > div {
        background: #181818 !important;
        color: #fff !important;
        box-shadow: 0 8px 32px rgba(0,0,0,0.6) !important;
      }
      #upload-page h2 {
        color: #fff;
      }
      #uploadForm input[type="file"] {
        background: #232323;
        color: #fff;
        border: 1px solid #333;
      }
      #uploadForm input[type="text"] {
        background: #232323;
        color: #fff;
        border: 1px solid #333;
      }
      #uploadForm button[type="submit"] {
        background: #ff0000;
        color: #fff;
      }
      #progress-bar-container {
        background: none;
      }
      #progress-bar-inner {
        background: #ff0000;
      }
      #progress-bar-text {
        color: #fff;
      }
      @media (max-width: 1100px) {
        .main-video-section {
          flex-direction: column;
          gap: 16px;
        }
        .main-video-player {
          max-width: 100vw;
        }
      }
      @media (max-width: 600px) {
        .video-container {
          grid-template-columns: 1fr;
          gap: 16px;
        }
        .main-video-title {
          font-size: 1rem;
          padding: 10px 10px 8px 10px;
        }
        .custom-controls {
          flex-direction: column;
          gap: 6px;
          padding: 6px 6px;
        }
        .custom-time {
          min-width: 40px;
        }
      }
    </style>
</head>
<body style="background:#111; color:#fff;">
    
    <nav class="flex-div" style="background:#181818;">
        <div class="nav-left flex-div">
            <img src="https://img.icons8.com/material-rounded/24/000000/menu--v1.png" class="menu-icon" alt="Menu">
            <img src="https://www.gstatic.com/youtube/img/promos/fe38d4a53254ac5e0e8c9594ee96c916bf250e46096a5c0caae38d5cc5d6cad4_244x112.webp" class="logo" alt="YouTube Logo" style="height:44px; width:auto; max-width:160px; object-fit:contain;">
        </div>
        <div class="nav-middle flex-div">
          <form id="search-form" class="search-form" onsubmit="event.preventDefault(); showOnlySearchedVideo();">
            <input 
              type="text" 
              id="search-input" 
              class="search-input" 
              name="search_query" 
              placeholder="Search"
              aria-label="Search"
              autocomplete="off"
              autocorrect="off"
              spellcheck="false"
              style="padding: 8px 12px; border-radius: 20px 0 0 20px; border: none; outline: none; width: 260px; background: #222; color: #fff; font-size: 1rem;"
            >
            <button 
              type="submit" 
              class="search-btn" 
              aria-label="Search"
              style="background: #222; border: none; border-radius: 0 20px 20px 0; padding: 8px 16px; cursor: pointer;"
            >
              <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" style="vertical-align: middle; color: #fff;">
                <path clip-rule="evenodd" d="M16.296 16.996a8 8 0 11.707-.708l3.909 3.91-.707.707-3.909-3.909zM18 11a7 7 0 00-14 0 7 7 0 1014 0z" fill-rule="evenodd"></path>
              </svg>
            </button>
          </form>
          <button 
            id="voice-search-btn" 
            aria-label="Search with your voice"
            style="background: none; border: none; margin-left: 8px; cursor: pointer; display: flex; align-items: center;"
            title="Search with your voice"
          >
            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" style="color: #fff;">
              <path d="M12 3c-1.66 0-3 1.37-3 3.07v5.86c0 1.7 1.34 3.07 3 3.07s3-1.37 3-3.07V6.07C15 4.37 13.66 3 12 3zm6.5 9h-1c0 3.03-2.47 5.5-5.5 5.5S6.5 15.03 6.5 12h-1c0 3.24 2.39 5.93 5.5 6.41V21h2v-2.59c3.11-.48 5.5-3.17 5.5-6.41z"></path>
            </svg>
          </button>
        </div>
        <script>
          // Show only the video that matches the search input (by filename or title)
          function showOnlySearchedVideo() {
            const query = document.getElementById('search-input').value.trim().toLowerCase();
            const videoCards = document.querySelectorAll('.video-card');
            let found = false;
            videoCards.forEach(card => {
              const filename = card.querySelector('.video-title') ? card.querySelector('.video-title').textContent.toLowerCase() : '';
              if (query === '') {
                card.style.display = '';
                found = true;
              } else if (filename.includes(query)) {
                card.style.display = '';
                found = true;
              } else {
                card.style.display = 'none';
              }
            });
          }
        </script>
        
           </script>
        </div>
        <div class="nav-right flex-div">
            <img src="https://img.icons8.com/ios-filled/50/000000/upload.png" alt="Upload" style="height:24px;cursor:pointer;" onclick="showUploadPage()">
            <div id="upload-page" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.85); z-index:9999; align-items:center; justify-content:center;">
              <div style="background:#181818; color:#fff; border-radius:10px; padding:32px 24px; min-width:320px; max-width:90vw; box-shadow:0 8px 32px rgba(0,0,0,0.6); display:flex; flex-direction:column; align-items:center; gap:24px; position:relative;">
                <button onclick="closeUploadPage()" style="position:absolute; top:12px; right:12px; background:none; border:none; font-size:1.5rem; cursor:pointer; color:#fff;">‚úñÔ∏è</button>
                <!-- YouTube Logo -->
                <img src="https://logos-world.net/wp-content/uploads/2020/04/YouTube-Logo.png" alt="YouTube Logo" style="height:20px; margin-bottom:16px;">
                <div class="yt-spec-touch-feedback-shape__fill"></div>
                <h2 style="margin:0 0 12px 0; color:#fff;">Upload Video</h2>
                <form id="uploadForm" enctype="multipart/form-data" style="display:flex; flex-direction:column; align-items:center; width:100%;">
                  <input type="file" name="file" accept="video/*" required style="margin-bottom:16px; background:#232323; color:#fff; border:1px solid #333;">
                  <input type="text" name="video_name" id="video_name" placeholder="Enter video name" required style="margin-bottom:16px; padding:8px; border-radius:4px; border:1px solid #333; width:100%; background:#232323; color:#fff;">
                  <button type="submit" style="padding:8px 24px; background:#ff0000; color:#fff; border:none; border-radius:4px; font-size:1rem; cursor:pointer;">Upload</button>
                  <div id="progress-bar-container" style="width:100%; margin-top:18px; display:none; flex-direction:column; align-items:center;">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b8/YouTube_Logo_2017.svg" alt="YouTube Logo" style="height:32px; margin-bottom:8px;">
                    <div style="width:100%; background:#222; border-radius:6px; overflow:hidden; height:16px;">
                      <div id="progress-bar-inner" style="height:100%; width:0%; background:#ff0000; transition:width 0.2s;"></div>
                    </div>
                    <span id="progress-bar-text" style="margin-top:6px; font-size:0.95rem; color:#fff;">Uploading...</span>
                  </div>
                </form>
              </div>
            </div>
            <script>
              // Function to open the upload page modal (renamed to openUploadModal)
              function openUploadModal() {
                document.getElementById('upload-page').style.display = 'flex';
                document.body.style.overflow = 'hidden';
                // Reset progress bar and form when opening
                document.getElementById('progress-bar-container').style.display = 'none';
                document.getElementById('progress-bar-inner').style.width = '0%';
                document.getElementById('progress-bar-text').textContent = 'Uploading...';
                document.getElementById('uploadForm').reset();
                // Re-enable form
                Array.from(document.getElementById('uploadForm').elements).forEach(el => el.disabled = false);
              }

              // Function to close the upload page modal (renamed to closeUploadModal)
              function closeUploadModal() {
                document.getElementById('upload-page').style.display = 'none';
                document.body.style.overflow = '';
                // Reset progress bar
                document.getElementById('progress-bar-container').style.display = 'none';
                document.getElementById('progress-bar-inner').style.width = '0%';
                document.getElementById('progress-bar-text').textContent = 'Uploading...';
                document.getElementById('uploadForm').reset();
                // Re-enable form
                Array.from(document.getElementById('uploadForm').elements).forEach(el => el.disabled = false);
              }

              // Add event listener to the upload button (if not already present)
              document.addEventListener('DOMContentLoaded', function() {
                // Find the upload icon and attach the click event
                const uploadIcon = document.querySelector('img[alt="Upload"]');
                if (uploadIcon) {
                  uploadIcon.onclick = openUploadModal;
                }
                // Also update the close button if it uses the old function name
                const closeBtn = document.querySelector('#upload-page button[onclick="closeUploadPage()"]');
                if (closeBtn) {
                  closeBtn.onclick = closeUploadModal;
                }
              });

              document.getElementById("uploadForm").addEventListener("submit", async (e) => {
                e.preventDefault();
                const form = e.target;
                const videoNameInput = form.querySelector('input[name="video_name"]');
                const fileInput = form.querySelector('input[type="file"][name="file"]');
                if (!videoNameInput.value.trim()) {
                  alert("Please enter a video name.");
                  videoNameInput.focus();
                  // Re-enable form if disabled
                  Array.from(form.elements).forEach(el => el.disabled = false);
                  return;
                }
                if (!fileInput.files || fileInput.files.length === 0) {
                  alert("Please select a video file.");
                  fileInput.focus();
                  Array.from(form.elements).forEach(el => el.disabled = false);
                  return;
                }

                // Create a new FormData and set the file with the user-provided name
                const formData = new FormData();
                const file = fileInput.files[0];
                const userFileName = videoNameInput.value.trim();

                // Extract extension from original file, if any
                let extension = "";
                const originalName = file.name;
                const lastDot = originalName.lastIndexOf(".");
                if (lastDot !== -1) {
                  extension = originalName.substring(lastDot);
                }

                // Sanitize userFileName (remove illegal filename characters for most OS)
                const safeFileName = userFileName.replace(/[\\/:*?"<>|]+/g, '').trim();

                // If user didn't provide extension, add original extension
                let finalFileName = safeFileName;
                if (extension && !safeFileName.endsWith(extension)) {
                  finalFileName += extension;
                }

                // Create a new File object with the user-provided name
                let fileToUpload;
                try {
                  fileToUpload = new File([file], finalFileName, { type: file.type });
                } catch (err) {
                  // Fallback for browsers that don't support File constructor
                  fileToUpload = file;
                }

                formData.append("file", fileToUpload, finalFileName);
                formData.append("video_name", userFileName);

                const progressBarContainer = document.getElementById('progress-bar-container');
                const progressBarInner = document.getElementById('progress-bar-inner');
                const progressBarText = document.getElementById('progress-bar-text');
                progressBarContainer.style.display = 'flex';
                progressBarInner.style.width = '0%';
                progressBarText.textContent = 'Uploading...';

                // Disable form during upload
                Array.from(form.elements).forEach(el => el.disabled = true);

                try {
                  const xhr = new XMLHttpRequest();
                  xhr.open("POST", "http://flask-alb-817303167.us-east-1.elb.amazonaws.com/upload", true);

                  xhr.upload.onprogress = function(event) {
                    if (event.lengthComputable) {
                      const percent = Math.round((event.loaded / event.total) * 100);
                      progressBarInner.style.width = percent + "%";
                      progressBarText.textContent = "Uploading... " + percent + "%";
                    }
                  };

                  xhr.onload = function() {
                    let result;
                    try {
                      result = JSON.parse(xhr.responseText);
                    } catch {
                      result = { error: "Unknown server response" };
                    }
                    if (xhr.status >= 200 && xhr.status < 300) {
                      progressBarInner.style.width = "100%";
                      progressBarText.textContent = "Processing...";
                      setTimeout(() => {
                        alert(result.message || "Upload successful!");
                        // reload videos after upload
                        if (typeof loadVideos === "function") {
                          loadVideos();
                        }
                        closeUploadModal();
                      }, 800);
                    } else {
                      progressBarText.textContent = "Upload failed";
                      alert(result.error || "Upload failed");
                      // Re-enable form
                      Array.from(document.getElementById('uploadForm').elements).forEach(el => el.disabled = false);
                    }
                  };

                  xhr.onerror = function() {
                    progressBarText.textContent = "Upload failed";
                    alert("Upload failed: Network error");
                    // Re-enable form
                    Array.from(document.getElementById('uploadForm').elements).forEach(el => el.disabled = false);
                  };

                  xhr.send(formData);
                } catch (err) {
                  progressBarText.textContent = "Upload failed";
                  alert("Upload failed: " + err.message);
                  // Re-enable form
                  Array.from(document.getElementById('uploadForm').elements).forEach(el => el.disabled = false);
                }
              });
            </script>
            <div style="position: relative; display: inline-block;">
              <img src="https://i.ibb.co/tpzStvsd/Screenshot-2024-03-10-150338.png" class="user-icon" alt="User" style="height:32px;border-radius:50%;cursor:pointer;" id="profileIcon">
              <div id="profileDropdown" style="display:none; position:absolute; right:0; top:40px; background:#232323; color:#fff; border-radius:8px; box-shadow:0 2px 12px rgba(0,0,0,0.25); min-width:320px; z-index:1000; padding:20px 0; text-align:left;">
                <div style="padding: 0 24px 16px 24px; text-align:center; border-bottom: 1px solid #333;">
                  <img src="https://i.ibb.co/tpzStvsd/Screenshot-2024-03-10-150338.png" alt="User" style="height:64px;width:64px;border-radius:50%;margin-bottom:10px;">
                  <div style="font-size:1.1rem; font-weight:600;">Abinash Kumar</div>
                  <div style="color:#bbb; font-size:0.95rem; margin-top:2px;">@abinash</div>
                  <div style="margin-top:10px;">
                    <button style="background:none;border:none;color:#1a73e8;font-weight:500;cursor:pointer;font-size:1rem;padding:0;">Google Account</button>
                  </div>
                </div>
                <div style="padding: 8px 0;">
                  <div style="padding: 0 24px;">
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">YouTube Studio</button>
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Purchases and memberships</button>
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Your data in YouTube</button>
                  </div>
                  <hr style="border:0;border-top:1px solid #333;margin:8px 0;">
                  <div style="padding: 0 24px;">
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Appearance: Device theme</button>
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Language: <span style="color:#bbb;">British English</span></button>
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Restricted Mode: <span style="color:#bbb;">Off</span></button>
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Location: <span style="color:#bbb;">India</span></button>
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Keyboard shortcuts</button>
                  </div>
                  <hr style="border:0;border-top:1px solid #333;margin:8px 0;">
                  <div style="padding: 0 24px;">
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Settings</button>
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Help</button>
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Send feedback</button>
                  </div>
                  <hr style="border:0;border-top:1px solid #333;margin:8px 0;">
                  <div style="padding: 0 24px;">
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Switch account</button>
                    <button style="background:none;border:none;color:#fff;cursor:pointer;width:100%;text-align:left;padding:10px 0;font-size:1rem;">Sign out</button>
                  </div>
                </div>
              </div>
            </div>
            <script>
              // Profile dropdown toggle
              const profileIcon = document.getElementById('profileIcon');
              const profileDropdown = document.getElementById('profileDropdown');
              document.addEventListener('click', function(e) {
                if (profileIcon.contains(e.target)) {
                  profileDropdown.style.display = profileDropdown.style.display === 'block' ? 'none' : 'block';
                } else if (!profileDropdown.contains(e.target)) {
                  profileDropdown.style.display = 'none';
                }
              });
            </script>
        </div>
    </nav>

    <!-- Side Bar -->

    <div class="sidebar">
        <div class="shortcut-links">
            <a id="endpoint" tabindex="-1" class="yt-simple-endpoint style-scope ytd-mini-guide-entry-renderer" title="Home" href="/" onclick="location.reload(); return false;">
              <yt-icon id="icon" class="guide-icon style-scope ytd-mini-guide-entry-renderer">
                <span class="yt-icon-shape style-scope yt-icon ytSpecIconShapeHost">
                  <div style="width: 100%; height: 100%; display: block; fill: currentcolor;">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" focusable="false" aria-hidden="true" style="pointer-events: none; display: inherit; width: 100%; height: 100%;">
                      <path clip-rule="evenodd" d="M22.146 11.146a.5.5 0 01-.353.854H20v7.5a1.5 1.5 0 01-1.5 1.5H14v-8h-4v8H5.5A1.5 1.5 0 014 19.5V12H2.207a.5.5 0 01-.353-.854L12 1l10.146 10.146Z" fill-rule="evenodd"></path>
                    </svg>
                  </div>
                </span>
              </yt-icon>
              <span class="title style-scope ytd-mini-guide-entry-renderer">Home</span>
              <tp-yt-paper-tooltip animation-delay="0" offset="4" position="right" class="style-scope ytd-mini-guide-entry-renderer" role="tooltip" tabindex="-1" aria-label="tooltip" hidden="" style="--paper-tooltip-delay-in: 0ms;">
                <div id="tooltip" class="style-scope tp-yt-paper-tooltip hidden" style-target="tooltip">
                  Home
                </div>
              </tp-yt-paper-tooltip>
              <yt-interaction class="style-scope ytd-mini-guide-entry-renderer">
                <div class="stroke style-scope yt-interaction"></div>
                <div class="fill style-scope yt-interaction"></div>
              </yt-interaction>
            </a>
            <ytd-mini-guide-entry-renderer class="style-scope ytd-mini-guide-renderer" system-icons="" frosted-glass="" role="tab" tabindex="0" aria-selected="false" aria-label="Shorts"><!--css-build:shady--><!--css_build_scope:ytd-mini-guide-entry-renderer--><!--css_build_styles:video.youtube.src.web.polymer.shared.ui.styles.yt_base_styles.yt.base.styles.css.js--><a id="endpoint" tabindex="-1" class="yt-simple-endpoint style-scope ytd-mini-guide-entry-renderer" title="Shorts">
  <yt-icon id="icon" class="guide-icon style-scope ytd-mini-guide-entry-renderer"><!--css-build:shady--><!--css_build_scope:yt-icon--><!--css_build_styles:video.youtube.src.web.polymer.shared.ui.styles.yt_base_styles.yt.base.styles.css.js,video.youtube.src.web.polymer.shared.core.yt_icon.yt.icon.css.js--><span class="yt-icon-shape style-scope yt-icon ytSpecIconShapeHost"><div style="width: 100%; height: 100%; display: block; fill: currentcolor;"><svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" focusable="false" aria-hidden="true" style="pointer-events: none; display: inherit; width: 100%; height: 100%;"><path clip-rule="evenodd" d="m7.61 15.719.392-.22v-2.24l-.534-.228-.942-.404c-.869-.372-1.4-1.15-1.446-1.974-.047-.823.39-1.642 1.203-2.097h.001L15.13 3.59c1.231-.689 2.785-.27 3.466.833.652 1.058.313 2.452-.879 3.118l-1.327.743-.388.217v2.243l.53.227.942.404c.869.372 1.4 1.15 1.446 1.974.047.823-.39 1.642-1.203 2.097l-.002.001-8.845 4.964-.001.001c-1.231.688-2.784.269-3.465-.834-.652-1.058-.313-2.451.879-3.118l1.327-.742Zm1.993 6.002c-1.905 1.066-4.356.46-5.475-1.355-1.057-1.713-.548-3.89 1.117-5.025a4.14 4.14 0 01.305-.189l1.327-.742-.942-.404a4.055 4.055 0 01-.709-.391c-.963-.666-1.578-1.718-1.644-2.877-.08-1.422.679-2.77 1.968-3.49l8.847-4.966c1.905-1.066 4.356-.46 5.475 1.355 1.057 1.713.548 3.89-1.117 5.025a4.074 4.074 0 01-.305.19l-1.327.742.942.403c.253.109.49.24.709.392.963.666 1.578 1.717 1.644 2.876.08 1.423-.679 2.77-1.968 3.491l-8.847 4.965ZM10 14.567a.25.25 0 00.374.217l4.45-2.567a.25.25 0 000-.433l-4.45-2.567a.25.25 0 00-.374.216v5.134Z" fill-rule="evenodd"></path></svg></div></span></yt-icon>
  <span class="title style-scope ytd-mini-guide-entry-renderer">Shorts</span>
  <tp-yt-paper-tooltip animation-delay="0" offset="4" position="right" class="style-scope ytd-mini-guide-entry-renderer" role="tooltip" tabindex="-1" aria-label="tooltip" hidden="" style="--paper-tooltip-delay-in: 0ms;"><!--css-build:shady--><!--css_build_scope:tp-yt-paper-tooltip--><!--css_build_styles:video.youtube.src.web.polymer.shared.ui.styles.yt_base_styles.yt.base.styles.css.js,third_party.javascript.youtube_components.tp_yt_paper_tooltip.tp.yt.paper.tooltip.css.js--><div id="tooltip" class="hidden style-scope tp-yt-paper-tooltip" style-target="tooltip">
  
    Shorts
  
</div>
</tp-yt-paper-tooltip>
  <yt-interaction class="style-scope ytd-mini-guide-entry-renderer"><!--css-build:shady--><!--css_build_scope:yt-interaction--><!--css_build_styles:video.youtube.src.web.polymer.shared.ui.styles.yt_base_styles.yt.base.styles.css.js,video.youtube.src.web.polymer.shared.ui.yt_interaction.yt.interaction.css.js--><div class="stroke style-scope yt-interaction"></div><div class="fill style-scope yt-interaction"></div></yt-interaction>
</a>
</ytd-mini-guide-entry-renderer>
            <ytd-mini-guide-entry-renderer class="style-scope ytd-mini-guide-renderer" system-icons="" frosted-glass="" role="tab" tabindex="0" aria-selected="true" aria-label="Subscriptions" is-active="">
              <a id="endpoint" tabindex="-1" class="yt-simple-endpoint style-scope ytd-mini-guide-entry-renderer" title="Subscriptions" href="#">
                <yt-icon id="icon" class="guide-icon style-scope ytd-mini-guide-entry-renderer">
                  <span class="yt-icon-shape style-scope yt-icon ytSpecIconShapeHost">
                    <div style="width: 100%; height: 100%; display: block; fill: currentcolor;">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" focusable="false" aria-hidden="true" style="pointer-events: none; display: inherit; width: 100%; height: 100%;">
                        <path clip-rule="evenodd" d="M5.5 3A1.5 1.5 0 004 4.5h16A1.5 1.5 0 0018.5 3h-13ZM2 7.5A1.5 1.5 0 013.5 6h17A1.5 1.5 0 0122 7.5v11a1.5 1.5 0 01-1.5 1.5h-17A1.5 1.5 0 012 18.5v-11Zm8 2.87a.5.5 0 01.752-.431L16 13l-5.248 3.061A.5.5 0 0110 15.63v-5.26Z" fill-rule="evenodd"></path>
                      </svg>
                    </div>
                  </span>
                </yt-icon>
                <span class="title style-scope ytd-mini-guide-entry-renderer">Subscriptions</span>
                <tp-yt-paper-tooltip animation-delay="0" offset="4" position="right" class="style-scope ytd-mini-guide-entry-renderer" role="tooltip" tabindex="-1" aria-label="tooltip" hidden="" style="--paper-tooltip-delay-in: 0ms;">
                  <div id="tooltip" class="style-scope tp-yt-paper-tooltip hidden" style-target="tooltip">
                    Subscriptions
                  </div>
                </tp-yt-paper-tooltip>
                <yt-interaction class="style-scope ytd-mini-guide-entry-renderer">
                  <div class="stroke style-scope yt-interaction"></div>
                  <div class="fill style-scope yt-interaction"></div>
                </yt-interaction>
              </a>
            </ytd-mini-guide-entry-renderer>
            <hr>
            <a href="#" style="display: flex; align-items: center; gap: 8px;">
              <span style="width:24px; height:24px; display:block;">
                <div style="width: 100%; height: 100%; display: block; fill: currentcolor;">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" focusable="false" aria-hidden="true" style="pointer-events: none; display: inherit; width: 100%; height: 100%;">
                    <path clip-rule="evenodd" d="M4 5c-.552 0-1 .448-1 1s.448 1 1 1h16c.552 0 1-.448 1-1s-.448-1-1-1H4Zm-1 5c0-.552.448-1 1-1h16c.552 0 1 .448 1 1s-.448 1-1 1H4c-.552 0-1-.448-1-1Zm11 3.862c0-.384.415-.625.748-.434L21 17l-6.252 3.573c-.333.19-.748-.05-.748-.435v-6.276ZM4 13c-.552 0-1 .448-1 1s.448 1 1 1h6c.552 0 1-.448 1-1s-.448-1-1-1H4Zm-1 5c0-.552.448-1 1-1h6c.552 0 1 .448 1 1s-.448 1-1 1H4c-.552 0-1-.448-1-1Z" fill-rule="evenodd"></path>
                  </svg>
                </div>
              </span>
              <p style="margin: 0;">Library</p>
            </a>
            <a href="#" style="display: flex; align-items: center; gap: 8px;">
              <span style="width:24px; height:24px; display:block;">
                <div style="width: 100%; height: 100%; display: block; fill: currentcolor;">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" focusable="false" aria-hidden="true" style="pointer-events: none; display: inherit; width: 100%; height: 100%;">
                    <path clip-rule="evenodd" d="M13.847 5.248c-1.638-.448-3.384-.285-4.91.458C7.853 6.233 6.933 7.026 6.254 8H8.5c.552 0 1 .448 1 1s-.448 1-1 1H3V4.5c0-.552.448-1 1-1s1 .448 1 1v1.843c.823-1.018 1.865-1.853 3.061-2.435 1.963-.956 4.207-1.165 6.313-.59 2.106.577 3.931 1.899 5.135 3.72 1.204 1.822 1.704 4.02 1.408 6.183-.296 2.163-1.369 4.145-3.018 5.576-1.649 1.431-3.762 2.214-5.945 2.203-2.184-.011-4.289-.816-5.923-2.264-1.634-1.448-2.686-3.441-2.96-5.607-.07-.548.319-1.049.867-1.118.548-.07 1.048.319 1.117.867.213 1.685 1.031 3.235 2.302 4.361 1.272 1.126 2.909 1.752 4.607 1.76 1.698.01 3.342-.6 4.624-1.712 1.283-1.113 2.117-2.655 2.347-4.337.23-1.683-.159-3.392-1.095-4.809-.936-1.417-2.355-2.445-3.993-2.893ZM13 7.5c0-.552-.448-1-1-1s-1 .448-1 1v5.015l.419.299 3.5 2.5c.45.32 1.074.217 1.395-.233.32-.45.217-1.074-.233-1.395L13 11.486V7.5Z" fill-rule="evenodd"></path>
                  </svg>
                </div>
              </span>
              <p style="margin: 0;">History</p>
            </a>
            <a href="#" style="display: flex; align-items: center; gap: 8px;">
              <span style="width:24px; height:24px; display:block;">
                <div style="width: 100%; height: 100%; display: block; fill: currentcolor;">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" focusable="false" aria-hidden="true" style="pointer-events: none; display: inherit; width: 100%; height: 100%;">
                    <path clip-rule="evenodd" d="M3.75 5c-.414 0-.75.336-.75.75s.336.75.75.75h16.5c.414 0 .75-.336.75-.75S20.664 5 20.25 5H3.75Zm0 4c-.414 0-.75.336-.75.75s.336.75.75.75h16.5c.414 0 .75-.336.75-.75S20.664 9 20.25 9H3.75Zm0 4c-.414 0-.75.336-.75.75s.336.75.75.75h8.5c.414 0 .75-.336.75-.75s-.336-.75-.75-.75h-8.5Zm8.5 4c.414 0 .75.336.75.75s-.336.75-.75.75h-8.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h8.5Zm3.498-3.572c-.333-.191-.748.05-.748.434v6.276c0 .384.415.625.748.434L22 17l-6.252-3.572Z" fill-rule="evenodd"></path>
                  </svg>
                </div>
              </span>
              <p style="margin: 0;">Playlist</p>
            </a>
            <a href="#" style="display: flex; align-items: center; gap: 8px;">
              <span style="width:24px; height:24px; display:block;">
                <div style="width: 100%; height: 100%; display: block; fill: currentcolor;">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" focusable="false" aria-hidden="true" style="pointer-events: none; display: inherit; width: 100%; height: 100%;">
                    <path clip-rule="evenodd" d="M20.5 12c0 4.694-3.806 8.5-8.5 8.5S3.5 16.694 3.5 12 7.306 3.5 12 3.5s8.5 3.806 8.5 8.5Zm1.5 0c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Zm-9.25-5c0-.414-.336-.75-.75-.75s-.75.336-.75.75v5.375l.3.225 4 3c.331.248.802.181 1.05-.15.248-.331.181-.801-.15-1.05l-3.7-2.775V7Z" fill-rule="evenodd"></path>
                  </svg>
                </div>
              </span>
              <p style="margin: 0;">Watch Later</p>
            </a>
            <hr>
        </div>
        <div class="subscribed-list">
            <h3>SUBSCRIPTIONS</h3>
            <a href="#"><img src="https://i.ibb.co/tpzStvsd/Screenshot-2024-03-10-150338.png" alt="abinash kumar"><p>abinash kumar</p></a>
            <a href="#"><img src="https://randomuser.me/api/portraits/men/33.jpg" alt="veera"><p>veera</p></a>
            <a href="#"><img src="https://randomuser.me/api/portraits/men/34.jpg" alt="Cameron Green"><p>cloud</p></a>
        </div>
    </div>

    <!-- Main Body -->
    <div class="container">
      <div class="banner">
        <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1200&q=80" alt="Banner" style="width:100%;border-radius:8px;">
      </div>
      <div id="main-content" class="main-content">
        <!-- Main video player and recommended videos (like YouTube) -->
        <div id="main-video-section" class="main-video-section" style="display:none;">
          <div class="main-video-player">
            <div id="custom-video-container">
              <video id="main-video" tabindex="0"></video>
              <div id="custom-controls" class="custom-controls">
                <button id="play-pause" class="custom-btn" title="Play/Pause">‚ñ∂Ô∏è</button>
                <div id="progress-container" class="custom-progress">
                  <div id="progress-bar" class="custom-progress-bar"></div>
                </div>
                <span id="current-time" class="custom-time">0:00</span>
                <span style="color:#fff;">/</span>
                <span id="duration" class="custom-time">0:00</span>
                <input id="volume" class="custom-volume" type="range" min="0" max="1" step="0.01" value="1" title="Volume">
                <button id="mute-btn" class="custom-btn" title="Mute/Unmute">üîä</button>
                <button id="fullscreen-btn" class="custom-btn" title="Fullscreen">‚õ∂</button>
                <button id="close-player" class="custom-btn" title="Close">‚úñÔ∏è</button>
              </div>
            </div>
            <div id="main-video-title" class="main-video-title"></div>
            <!-- Removed main-video-details (views, date, channel, subscribe) -->
          </div>
          <!-- Removed recommended-videos -->
        </div>
        <!-- Video grid and error message containers -->
        <div id="video-list" class="video-container"></div>
        <div id="error-message" class="error"></div>
      </div>
    </div>

    <script>
    // Store videos globally
    let allVideos = [];
    let currentVideoIndex = -1;

    // DOM elements
    const mainVideoSection = document.getElementById('main-video-section');
    const mainVideo = document.getElementById('main-video');
    const mainVideoTitle = document.getElementById('main-video-title');
    // Removed mainVideoDetails and recommendedVideos
    const videoList = document.getElementById('video-list');
    const customControls = document.getElementById('custom-controls');
    const playPauseBtn = document.getElementById('play-pause');
    const progressContainer = document.getElementById('progress-container');
    const progressBar = document.getElementById('progress-bar');
    const currentTimeEl = document.getElementById('current-time');
    const durationEl = document.getElementById('duration');
    const volumeSlider = document.getElementById('volume');
    const muteBtn = document.getElementById('mute-btn');
    const fullscreenBtn = document.getElementById('fullscreen-btn');
    const closePlayerBtn = document.getElementById('close-player');

    // Helper: Format time
    function formatTime(sec) {
      if (isNaN(sec)) return "0:00";
      const m = Math.floor(sec / 60);
      const s = Math.floor(sec % 60);
      return `${m}:${s.toString().padStart(2, '0')}`;
    }

    // --- VIEWS LOGIC ---
    // Track views in-memory for this session
    let videoViews = {};

    // When a video is played, increment its views and update backend
    async function incrementView(index) {
      const video = allVideos[index];
      if (!video) return;
      // Only increment if not already incremented in this session
      if (!videoViews[video.url]) {
        videoViews[video.url] = true;
        // Try to update backend (if API supports)
        try {
          await fetch("http://flask-alb-817303167.us-east-1.elb.amazonaws.com/increment_view", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ url: video.url })
          });
        } catch (e) {
          // Ignore backend errors for now
        }
      }
    }

    function showMainVideoSection(index) {
      if (!allVideos[index]) return;
      currentVideoIndex = index;
      const video = allVideos[index];

      // Increment view count like YouTube (only when user actually plays)
      incrementView(index);

      mainVideo.src = video.url;
      mainVideoTitle.textContent = video.title ? video.title : video.file;
      // Removed video details (views, date, channel, subscribe)
      mainVideoSection.style.display = 'flex';
      videoList.style.display = 'none';
      mainVideo.load();
      mainVideo.play();
      mainVideo.scrollIntoView({behavior: "smooth"});
      // Removed renderRecommendedVideos
    }

    // Removed renderRecommendedVideos

    async function loadVideos() {
      const errorDiv = document.getElementById("error-message");
      errorDiv.textContent = ""; // clear old errors

      try {
        const response = await fetch("http://flask-alb-817303167.us-east-1.elb.amazonaws.com/videos"); // replace with your backend URL

        if (!response.ok) {
          throw new Error(`Server returned ${response.status} ${response.statusText}`);
        }

        const videos = await response.json();
        allVideos = Array.isArray(videos) ? videos : [];

        videoList.innerHTML = "";

        if (!Array.isArray(videos) || videos.length === 0) {
          videoList.innerHTML = "<p>No videos found.</p>";
          return;
        }

        // YouTube-like grid
        videos.forEach((video, idx) => {
          const card = document.createElement("div");
          card.className = "video-card";
          card.tabIndex = 0;

          // Thumbnail video (not playable in grid)
          const vid = document.createElement("video");
          vid.src = video.url;
          vid.muted = true;
          vid.playsInline = true;
          vid.preload = "metadata";
          vid.setAttribute('aria-label', video.title ? video.title : video.file);
          vid.setAttribute('tabindex', '-1');
          vid.className = "video-thumb";

          // Prevent play/pause in grid
          vid.addEventListener('play', e => { vid.pause(); });

          const info = document.createElement("div");
          info.className = "video-info";
          info.innerHTML = `
            <div class="video-title">${video.title ? video.title : video.file}</div>
          `;

          card.appendChild(vid);
          card.appendChild(info);

          // Open main video section on click or Enter key
          card.addEventListener('click', () => {
            showMainVideoSection(idx);
          });
          card.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              showMainVideoSection(idx);
            }
          });

          videoList.appendChild(card);
        });
      } catch (err) {
        console.error("Error loading videos:", err);
        errorDiv.textContent = "‚ö†Ô∏è Error: " + err.message;
      }
    }

    // Custom video player controls logic
    let controlsTimeout;
    function showControls() {
      customControls.classList.remove('hide');
      clearTimeout(controlsTimeout);
      controlsTimeout = setTimeout(() => {
        if (!mainVideo.paused) customControls.classList.add('hide');
      }, 2500);
    }
    function hideControls() {
      if (!mainVideo.paused) customControls.classList.add('hide');
    }

    mainVideo.addEventListener('mousemove', showControls);
    mainVideo.addEventListener('mouseleave', hideControls);
    mainVideo.addEventListener('play', showControls);
    mainVideo.addEventListener('pause', () => customControls.classList.remove('hide'));
    customControls.addEventListener('mousemove', showControls);

    playPauseBtn.addEventListener('click', () => {
      if (mainVideo.paused) {
        mainVideo.play();
      } else {
        mainVideo.pause();
      }
    });

    mainVideo.addEventListener('play', () => {
      playPauseBtn.textContent = '‚è∏Ô∏è';
      // When user actually plays, increment view and update UI
      if (currentVideoIndex !== -1) {
        incrementView(currentVideoIndex);
      }
    });
    mainVideo.addEventListener('pause', () => {
      playPauseBtn.textContent = '‚ñ∂Ô∏è';
    });

    mainVideo.addEventListener('timeupdate', () => {
      const percent = (mainVideo.currentTime / mainVideo.duration) * 100;
      progressBar.style.width = percent + "%";
      currentTimeEl.textContent = formatTime(mainVideo.currentTime);
    });

    mainVideo.addEventListener('loadedmetadata', () => {
      durationEl.textContent = formatTime(mainVideo.duration);
      currentTimeEl.textContent = formatTime(mainVideo.currentTime);
    });

    progressContainer.addEventListener('click', (e) => {
      const rect = progressContainer.getBoundingClientRect();
      const percent = (e.clientX - rect.left) / rect.width;
      mainVideo.currentTime = percent * mainVideo.duration;
    });

    volumeSlider.addEventListener('input', () => {
      mainVideo.volume = volumeSlider.value;
      muteBtn.textContent = mainVideo.muted || mainVideo.volume === 0 ? 'üîá' : 'üîä';
    });

    muteBtn.addEventListener('click', () => {
      mainVideo.muted = !mainVideo.muted;
      muteBtn.textContent = mainVideo.muted ? 'üîá' : 'üîä';
      volumeSlider.value = mainVideo.muted ? 0 : mainVideo.volume;
    });

    fullscreenBtn.addEventListener('click', () => {
      const container = document.getElementById('custom-video-container');
      if (document.fullscreenElement) {
        document.exitFullscreen();
      } else {
        container.requestFullscreen();
      }
    });

    closePlayerBtn.addEventListener('click', () => {
      mainVideoSection.style.display = 'none';
      videoList.style.display = '';
      currentVideoIndex = -1;
      mainVideo.pause();
      mainVideo.src = '';
      mainVideoTitle.textContent = '';
      // Removed mainVideoDetails and recommendedVideos
    });

    // Optionally, allow user to go back to grid (like YouTube logo click)
    document.querySelector('.logo').addEventListener('click', function() {
      mainVideoSection.style.display = 'none';
      videoList.style.display = '';
      currentVideoIndex = -1;
      mainVideo.pause();
      mainVideo.src = '';
      mainVideoTitle.textContent = '';
      // Removed mainVideoDetails and recommendedVideos
      window.scrollTo({top: 0, behavior: "smooth"});
    });

    // Keyboard shortcuts for video player
    mainVideo.addEventListener('keydown', (e) => {
      if (e.key === ' ' || e.key === 'k') {
        e.preventDefault();
        if (mainVideo.paused) mainVideo.play();
        else mainVideo.pause();
      }
      if (e.key === 'ArrowLeft') {
        mainVideo.currentTime = Math.max(0, mainVideo.currentTime - 5);
      }
      if (e.key === 'ArrowRight') {
        mainVideo.currentTime = Math.min(mainVideo.duration, mainVideo.currentTime + 5);
      }
      if (e.key === 'f') {
        fullscreenBtn.click();
      }
      if (e.key === 'm') {
        muteBtn.click();
      }
      if (e.key === 'Escape') {
        closePlayerBtn.click();
      }
    });

    // Load videos on page load
    loadVideos();
    </script>

    <script src="sidebar.js"></script>

</body>
</html>